<!DOCTYPE html>
<!--[if lt IE 7]>      <html xmlns:fb="http://ogp.me/ns/fb#" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns:fb="http://ogp.me/ns/fb#" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns:fb="http://ogp.me/ns/fb#" class="no-js lt-ie9"> <![endif]-->
<!--[if IE 9]>         <html xmlns:fb="http://ogp.me/ns/fb#" class="no-js ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html xmlns:fb="http://ogp.me/ns/fb#" class="no-js">
<!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">
        <title>{{ config.metadata.title }}</title>
        <meta name="description" content="{{ config.metadata.description }}">
        <meta property="og:title" content="{{ config.metadata.title }}" />
        <meta property="og:description" content="{{ config.metadata.description }}" />
        <meta property="og:url" content="{{ config.facebook.canvas_page }}" />
        <!-- <meta property="og:image" content="{{ siteUrl('/img/app_image.jpg') }}" /> -->
        <link rel="stylesheet" href="{{ siteUrl('/css/main.css') }}">
        <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
        <div id="fb-root"></div>
        <div class="container">
            {% block content %}{% endblock %}
        </div>
        <script>
        // Load the FB SDK asynchronously
        (function(d, s, id){
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, "script", "facebook-jssdk"));

        window.fbAsyncInit = function() {
            // init FB JS SDK
            FB.init({
                appId      : "{{ config.facebook.appid }}",
                channelUrl : "{{ siteUrl('/channel') }}", // Channel File for x-domain communication
                status     : true, // check the login status upon init?
                cookie     : true, // set sessions cookies to allow your server to access the session?
                xfbml      : true  // parse XFBML tags on this page?
            });
            FB.Canvas.setAutoGrow();
            // watch for the like button being pressed, refresh page
            FB.Event.subscribe("edge.create", function(resp) {
                setTimeout(function() {
                    try {
                        window.location.reload();
                    } catch(er) {}
                }, 100);
            });
        };

        // share dialog
        function share(image) {
            var obj = {
                picture: image,
                method: "feed",
                redirect_uri: "{{ config.facebook.canvas_page }}",
                link: "{{ config.facebook.canvas_page }}",
                description: "{{ config.metadata.description }}",
                // debug fb errors
                show_error: true
            };
            FB.ui(obj);
        }
        </script>
        {% block scripts %}{% endblock %}
    </body>
</html>
